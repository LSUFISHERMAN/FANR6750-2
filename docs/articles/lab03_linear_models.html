<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 3: Introduction to Linear Models • FANR6750</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 3: Introduction to Linear Models">
<meta property="og:description" content="FANR6750">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FANR6750</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2023.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/01_intro_to_stats/01_intro_to_stats.html">Lecture 1: Introduction to statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/02_intro_to_lm/02_intro_to_lm.html">Lecture 2: Introduction to linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/03_inference/03_inference.html">Lecture 3: Principles of inference</a>
    </li>
    <li>
      <a href="../articles/lectures/04_t-test/04_t-test.html">Lecture 4: Linear models part 1: categorical predictor w/ 2 levels</a>
    </li>
    <li>
      <a href="../articles/lectures/05_nht/05_nht.html">Lecture 5: Null hypothesis significance testings</a>
    </li>
    <li>
      <a href="../articles/lectures/06_power/06_power.html">Lecture 6: Statistical power</a>
    </li>
    <li>
      <a href="../articles/lectures/07_anova/07_anova.html">Lecture 7: Linear models part 2: categorical predictor &gt; 2 levels</a>
    </li>
    <li>
      <a href="../articles/lectures/08_mult_comp/08_mult_comp.html">Lecture 8: Multiple Comparisons</a>
    </li>
    <li>
      <a href="../articles/lectures/09_regression/09_regression.html">Lecture 9: Multiple Regression</a>
    </li>
    <li>
      <a href="../articles/lectures/10_interactions/10_interactions.html">Lecture 10: Interactions</a>
    </li>
    <li>
      <a href="../articles/lectures/11_assumptions/11_assumptions.html">Lecture 11: Evaluating assumptions</a>
    </li>
    <li>
      <a href="../articles/lectures/12_model_selection/12_model_selection.html">Lecture 12: Model selection</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab01_intro_to_R.html">Lab 1: Introduction to R</a>
    </li>
    <li>
      <a href="../articles/lab02_Intro_project_and_RMD.html">Lab 2: Introduction to projects and RMarkdown</a>
    </li>
    <li>
      <a href="../articles/lab03_t-tests.html">Lab 3: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab04_ANOVA.html">Lab 4: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab05_multiple_regression.html">Lab 5: Multiple Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework.html">Assignment instructions</a>
    </li>
    <li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/RMarkdown.html">R Markdown reference</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Creating publication-quality graphics</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 3: Introduction to Linear Models</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2023</h4>
            
      
      
      <div class="hidden name"><code>lab03_linear_models.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="lab-2">Lab 2<a class="anchor" aria-label="anchor" href="#lab-2"></a>
</h3>
<ul>
<li><p>Introduction to R Markdown</p></li>
<li><p>Creating R Markdown files</p></li>
<li><p>Creating code chunks</p></li>
<li><p>Using RStudio Projects</p></li>
<li><p>Organizing directories and subdirectories</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="todays-topics">Today’s topics<a class="anchor" aria-label="anchor" href="#todays-topics"></a>
</h3>
<ul>
<li><p>Introduction to linear models</p></li>
<li>
<p>Simple Linear Regression</p>
<ul>
<li><p>Parameter interpretation</p></li>
<li><p>Residuals</p></li>
<li><p>Assumptions of linear models</p></li>
</ul>
</li>
<li>
<p>Linear models in R</p>
<ul>
<li><p>A brief aside about R graphics</p></li>
<li><p>Parameter interpretation in R</p></li>
</ul>
</li>
</ul>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="what-is-a-linear-model">What is a Linear Model?<a class="anchor" aria-label="anchor" href="#what-is-a-linear-model"></a>
</h2>
<p>Formally, a linear model is defined as <strong>a model that specifies
a linear relationship between a response variable and a number of
predictor variables.</strong></p>
<p><br></p>
<p>Below is an example of a linear model. We will call this the “General
Linear Model” because it does not represent a specific model but rather
represents all linear models in general.</p>
<p><span class="math display">\[
\overbrace{{y_i}}^\text{response} = \underbrace{\color{red}{\beta_0} +
\color{red}{\beta_1}{x_{i1}} + \color{red}{\beta_2}{x_{i2}} + ... +
\color{red}{\beta_p}{x_{ip}}}_\text{Deterministic} +
\overbrace{\color{red}{\epsilon_i}}^\text{stochastic}
\]</span></p>
<p>where:</p>
<p><span class="math inline">\(y\)</span> = the response</p>
<p><span class="math inline">\(\beta\)</span> = the effect that a
particular predictor has on the response</p>
<p><span class="math inline">\(x\)</span> = a predictor</p>
<p><span class="math inline">\(\epsilon\)</span> = residuals</p>
<p><br></p>
<p>Note: Some of the values are highlighted in <span class="math inline">\(\color{red}{red}\)</span>. This is showing the
fact that these values are estimated <strong>from</strong> the model
whereas the other values are provided <strong>to</strong> the model in
the form of data.</p>
<p><br></p>
<p>Note: The deterministic part is the part that we can account for
given the data that we have. The stochastic portion is the extra bit
(randomness) for which our model does not account.</p>
<p><br></p>
<p>Also keep in mind that the predictor variables (<span class="math inline">\(x_i\)</span>) may take many forms. What are some
examples of the types below?</p>
<ul>
<li>Continuous</li>
<li>Binary</li>
<li>Factors</li>
</ul>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="simple-linear-regression">Simple Linear Regression<a class="anchor" aria-label="anchor" href="#simple-linear-regression"></a>
</h2>
<p>Let’s look at an example of a linear model with only one continuous
predictor. In this dataset, the yearly rainfall (mm) is being used to
predict the average number of acorns produced by White Oaks (<em>Quercus
alba</em>) in north Georgia.</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1x_i + \epsilon_i \ \ \ \ \ \text{where} \ \ \ \ \
\epsilon_i \sim \text{N}(0,\sigma)
\]</span> Here we have an example where the response variable (y) is
being predicted using only one predictor variable (x).</p>
<p><img src="lab03_linear_models_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
<div class="section level3">
<h3 id="parameter-interpretation">Parameter Interpretation<a class="anchor" aria-label="anchor" href="#parameter-interpretation"></a>
</h3>
<p>Above, we have written a linear model which predicts the number of
acorns on an average White Oak tree using the yearly rainfall. Before
moving forward, let’s talk about how we would interpret the <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in our model.</p>
<p><br></p>
<p><span class="math inline">\(\beta_0\)</span>: Intercept; the expected
value of <span class="math inline">\(y_i\)</span> when all predictors =
0</p>
<p><span class="math inline">\(\beta_1\)</span>: Slope: the expected
change in <span class="math inline">\(y_i\)</span> resulting from one
unit change in the associated predictor variable <span class="math inline">\(x_n\)</span></p>
<p><br><br></p>
<p>A few questions to think about related to these:</p>
<ol style="list-style-type: decimal">
<li><p>What is the biological meaning of the intercept? Does it have a
biological meaning?</p></li>
<li><p>What are the units of the predictor variables (e.g., mm, <span class="math inline">\(\mu L\)</span>, % canopy cover)?</p></li>
</ol>
<p><br></p>
</div>
<div class="section level3">
<h3 id="residuals">Residuals<a class="anchor" aria-label="anchor" href="#residuals"></a>
</h3>
<p>Keep in mind that in any linear model that we create, we will not be
able to perfectly predict a response given a set of predictor variables.
This is especially true in ecological systems where data are often quite
messy. As a result, we can see above that even though we have fitted a
prediction line through the dataset, it overestimates the number of
acorns at some values of rainfall and underestimates at others.</p>
<p><br></p>
<p>These differences between the observed values of the response (<span class="math inline">\(y_i\)</span>) and the predicted values of the
response from our model (<span class="math inline">\(E[y_i]\)</span>)
are known as <strong>Residuals</strong>. These residuals represent the
variation in <span class="math inline">\(y_i\)</span> which is not
explained by any <span class="math inline">\(x_i\)</span> in our
model.</p>
<p><br></p>
<p>Later in the lab, when we attempt to estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> above, we will do this by
minimizing the size of the residuals (e.g., ordinary least squares).</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="assumptions-of-linear-models">Assumptions of linear models<a class="anchor" aria-label="anchor" href="#assumptions-of-linear-models"></a>
</h3>
<p>When we are using <code>R</code> to help with data analysis, keep in
mind that, for the most part, <code>R</code> is happy to do anything
that you tell it to do. In reality though, every linear model that we
will use this semester will come with a set of assumptions. Before using
any model for data analysis, you will need to consider the assumptions
of that model and decide whether or not it is reasonable to make those
assumptions. If it is, that model may be appropriate for that analysis;
if it is not, you will need to consider other options.</p>
<p>All linear models have at least 6 explicit assumptions. In this
course, we will primarily consider the first 4 of these assumptions, but
it is good to know that the others (and usually more) exist. As we
progress through the course, we will see how we can test these
assumptions and what our options are when the assumptions are not
met.</p>
<p>As we go through these assumptions try to find in our linear model
where these assumptions show up (some are more subtle than others).</p>
<ol style="list-style-type: decimal">
<li>
<strong>Linearity:</strong> We assume that the relationship between
x and y is linear</li>
</ol>
<p><br></p>
<p>Note: This assumption <strong>DOES NOT</strong> mean that we need to
be able to fit a straight line through the data. Often, we will actually
used a curved line (in the cases of quadratic relationships). Rather,
this assumption means that the <strong>parameters</strong> themselves
enter the model linearly. This means that for one unit change in a
predictor, there is <strong>ALWAYS</strong> the same constant change in
the response.</p>
<p>Let’s see some examples:</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1x_1 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1x_1 + \beta_2x_1^2 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1x_1 + \beta_2x_2x_3 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
y_i = \beta_0 + x_1^{\beta_1} + \beta_2x_1^2 + \epsilon_i
\]</span> <br></p>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Normality:</strong> We assume that the residuals are
normally distributed</li>
</ol>
<p>This assumption will be important as we progress through the semester
and perform hypothesis testing to assess the significance of predictor
variables. While normality of residuals is not required, it suggests
that the model is doing a good job of predicting the response (i.e. most
residuals are close to zero and larger errors are much less likely).</p>
<p><br><br></p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>Homoscedasticity:</strong> We assume that the residuals have
a constant variance across all levels or values of x (if not, we refer
to that as heterscedasticity)</li>
</ol>
<p>Variance of the residuals can best be seen by creating a plot of the
model residuals across the range of a predictor.</p>
<p><img src="lab03_linear_models_files/figure-html/unnamed-chunk-3-1.png" width="768"><br><br></p>
<p>When might this assumption be violated?</p>
<ul>
<li>In factors</li>
<li>In time series</li>
<li>In cross sectional studies</li>
</ul>
<p><br><br></p>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>Independence:</strong> We assume that the residuals are
independent of one another and independent of predictors.</li>
</ol>
<p>This assumption means that we cannot predict the size of a residual
from another residual (autocorrelation) or from the value of a predictor
variable (endogeneity).</p>
<p>When might this assumption be violated?</p>
<p><br><br></p>
<ol start="5" style="list-style-type: decimal">
<li>
<strong>Unbiased estimator:</strong> We assume that the residuals
are centered on zero.</li>
</ol>
<p>If the residuals are centered on zero, then our estimate of the
parameter is doing a good job of approximating the true value of the
parameter. If the residuals are not centered on zero, then the model is
either consistenly under or over estimating the parameter values (a
biased estimator).</p>
<p><img src="lab03_linear_models_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p><br><br></p>
<ol start="6" style="list-style-type: decimal">
<li>
<strong>Independent predictors:</strong> We assume that when using
multiple predictor variables, they are independent from one
another.</li>
</ol>
<p>If one explanatory variable is able to be predicted using others (the
information provided by the variable is redundant) then we refer to that
as multicollinearity.</p>
<p><br><br></p>
<p>What are some examples?</p>
<p><br><br></p>
<ul>
<li>Predicting nest survival using both Fahrenheit and Celsius</li>
</ul>
<p><br></p>
<ul>
<li>Predicting presence of birds using % land use categories</li>
</ul>
<p><br></p>
<ul>
<li>Predicting movement of fish using dissolved oxygen, salinity, and
conductivity</li>
</ul>
<p><br><br></p>
</div>
</div>
<div class="section level2">
<h2 id="linear-models-in-r">Linear models in R<a class="anchor" aria-label="anchor" href="#linear-models-in-r"></a>
</h2>
<p>Above, we have seen an example of a linear model with only one
continuous predictor variable. Now we will see how we might create this
model in <code>R</code>.</p>
<div class="section level3">
<h3 id="exercise-1">Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Open your ‘FANR6750’ Rstudio project (if you have one)</p></li>
<li><p>Create a new ‘R’ script and save it to the directory where you
store your lab activities. Name it something like ‘lab03-SLR.R’</p></li>
<li><p>Load the ‘FANR6750’ package and the ‘raindata’ object</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'raindata'</span><span class="op">)</span></span></code></pre></div>
<p>Before we do anything else, lets examine our dataset and plot the
rainfall-acorn relationship.</p>
</div>
<div class="section level3">
<h3 id="graphics">Graphics<a class="anchor" aria-label="anchor" href="#graphics"></a>
</h3>
<p><code>R</code> has very powerful graphing capabilities that make it
possible to create data visualizations for reports or publications. As
with most tasks in <code>R</code>, there are many ways to create graphs
and you will find that people have very strong feelings about the best
approach.</p>
<p>The debate over graphics in <code>R</code> usually boils down to
using the built-in graphing functions (“base graphics”) vs the
<code>ggplot2</code> package. There are some advantages to both
approaches, but for the most part the newer generations of
<code>R</code> users prefer <code>ggplot2</code>. Therefore most of the
sample code provided in lab will reflect that preference. However,
<strong>I don’t care how you make your plots as long as they effectively
display the information you are trying to convey</strong>. If you prefer
base graphics, by all means use base graphics.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="section level4">
<h4 id="brief-introduction-to-ggplot2">Brief introduction to <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#brief-introduction-to-ggplot2"></a>
</h4>
<p>Because the code I provide will use <code>ggplot2</code>, it is worth
briefly learning/reviewing how this package approaches data
visualization.</p>
<p>The power and flexibility of <code>ggplot2</code> come from it’s
consistent structure. Although a bit confusing at first, once you get
the hang of it, the structure actually makes it quite easy to create
highly customized visualizations. All plots created using
<code>ggplot2</code> use the same underlying structure:</p>
<p><span class="math display">\[\underbrace{ggplot}_{initiate\;
plot}(\underbrace{data = df}_{data\;frame},\; \underbrace{aes(x =\; , y
= \;)}_{plot\; attributes}) +
\underbrace{geom\_line()}_{geometry}\]</span></p>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> function initiates a new plot. In this
function, you tell <code>ggplot2</code> what data frame you will be
using for the plot (<code>ggplot</code> only accepts data frames as
input) and you tell it how to map attributes of the data to the visual
properties of the figures. Attributes are mapped inside the
<code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> argument. Attributes usually include location
(<code>x-axis</code> and <code>y-axis</code> placement), color, size,
shape, line type, and many others. In general, <strong>each attribute
will be mapped to one column of your data frame</strong>.</p>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> function simply initiates a graph - if you
run just that portion of the code you will get a blank graph. We can see
that by creating a new plot showing the relationship between
<code>rainfall</code> (the x-axis of the plot) and <code>acorns</code>
(the y-axis):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">raindata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rainfall</span>, y <span class="op">=</span> <span class="va">acorns</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_linear_models_files/figure-html/unnamed-chunk-6-1.png" width="480" style="display: block; margin: auto;"></p>
<p>You can see that <code>ggplot</code> created a figure with the
correct axes and labels. But no data. That’s because we didn’t tell
<code>ggplot</code> what type of <em>geometry</em> to use to represent
the data. Geometry refers to the type of geometric object(s) we want to
use to display the data. Common geometries include points (e.g., scatter
plot), lines (e.g., time series), and bars (e.g., histograms). There are
many others. Once we add a geometry, we can see the data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">raindata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rainfall</span>, y <span class="op">=</span> <span class="va">acorns</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_linear_models_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="back-to-simple-linear-regression">Back to Simple Linear Regression<a class="anchor" aria-label="anchor" href="#back-to-simple-linear-regression"></a>
</h2>
<p>Now that we have plotted the data, we can see that there appears to
be a linear relationship between the rainfall in a particular year and
the acorn production of White Oaks. Next, we will perform Simple Linear
Regression in <code>R</code> to estimate the intercept and slope of the
regression line.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">acorns</span><span class="op">~</span> <span class="va">rainfall</span>, data<span class="op">=</span> <span class="va">raindata</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># It is often helpful to adjust the way R displays numbers to avoid having to </span></span>
<span><span class="co"># interpret scientific notation. One way we can do that is using the options function.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen<span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = acorns ~ rainfall, data = raindata)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -130.821  -28.007   -0.114   26.904  134.951 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value            Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 10009.3355    29.0556 344.488 &lt;0.0000000000000002 ***</span></span>
<span><span class="co">#&gt; rainfall        1.5093     0.5882   2.566              0.0118 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 47.01 on 98 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.06296,    Adjusted R-squared:  0.0534 </span></span>
<span><span class="co">#&gt; F-statistic: 6.584 on 1 and 98 DF,  p-value: 0.0118</span></span></code></pre></div>
<div class="section level3">
<h3 id="parameter-interpretation-in-r">Parameter interpretation in R<a class="anchor" aria-label="anchor" href="#parameter-interpretation-in-r"></a>
</h3>
<p>One of the most important parts of using <code>R</code> for data
analysis will be learning to interpret the results provided as
output.</p>
<p>How should we interpret these model parameters? What do they mean in
the context of the statistical model and in the context of the
biological data?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Now let's plot our model predictions</span></span>
<span><span class="va">mod1_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">raindata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rainfall</span>, y <span class="op">=</span> <span class="va">acorns</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rainfall</span>, y<span class="op">=</span> <span class="va">mod1_fit</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab03_linear_models_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<p><br><br><br></p>
</div>
</div>
<div class="section level2">
<h2 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h2>
<p>In this data example, a researcher is interested in using the average
density of feral cats (cats/square mile) in 100 city parks across the US
to predict the number of lizards/square mile (prey) at those parks.</p>
<p>Create an R Markdown file to do the following:</p>
<ol style="list-style-type: decimal">
<li>Create an <code>R</code> chunk to load the prey data using:</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"preydata"</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Make a figure that plots the raw data. Keep in mind which axis
you will want to plot the predictor variable vs the response
variable.</p></li>
<li><p>Create a content header called “Linear Model” and under this
header, use R Markdown’s equation editor to write the linear model you
will use to help answer this researcher’s question. Remember to include
all parts of the model including how you would specify the residual
structure. Below the model, make sure to define what every term in the
model means.</p></li>
<li><p>Create a header called “Linear Models in R”. Use the
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function to translate your linear model into
<code>R</code> and look at the summary of results.</p></li>
<li><p>Interpret the results of your model. Explain what each parameter
means both in terms of the model as well as biologically.</p></li>
<li><p>Make a new plot which shows both the raw data as well as the
fitted line from your model.</p></li>
<li><p>Add a section at the end of your file called “Discussion” and
address the following questions.</p></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>What would happen if we tried to use this model to make
predictions outside the range of our data? Would it still be a useful
model? Why or why not?</p></li>
<li><p>How many lizards would there be if the density of cats = 80?
Explain what is happening here and how you might resolve this
issue?</p></li>
<li><p>Below are two figures. The first shows the residuals of the model
plotted against the predicted (fitted) values along with a horizontal
line showing the mean of the residuals. The second plot is a histogram
of the residuals. Which assumptions of linear models do these plots
address? Based on what you see, do these assumptions appear to be
appropriate?</p></li>
</ol>
<p><img src="lab03_linear_models_files/figure-html/unnamed-chunk-12-1.png" width="700"><img src="lab03_linear_models_files/figure-html/unnamed-chunk-12-2.png" width="700"></p>
<p>A few things to remember when creating the document:</p>
<ul>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so that all code and output is visible in the knitted
document</p></li>
<li><p>Regularly knit the document as you work to check for
errors</p></li>
<li><p>See the R Markdown reference sheet for help with creating
<code>R</code> chunks, equations, tables, etc.</p></li>
</ul>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Keep in mind that although we will be using ggplot2, it
is a good idea to have some understanding of how base <code>R</code>
graphics work. Most packages in <code>R</code>, when they produce some
sort of output in the form of a plot, will still create that plot using
base <code>R</code> graphics rather than ggplot. In order to alter those
graphics without having to start from scratch, it will be useful to know
a little about base <code>R</code> graphics.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
